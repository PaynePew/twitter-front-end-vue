(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e03ca1a"],{3061:function(t,e,n){"use strict";n("6111")},6111:function(t,e,n){},7696:function(t,e,n){"use strict";n("b0c0");var r=n("2fa3");e["a"]={signIn:function(t){var e=t.account,n=t.password;return r["a"].post("/users/signin",{account:e,password:n})},signUp:function(t){var e=t.name,n=t.account,o=t.email,c=t.password,a=t.checkPassword;return r["a"].post("/users",{name:e,account:n,email:o,password:c,checkPassword:a})}}},"900e":function(t,e,n){},"9ddf":function(t,e,n){"use strict";n.r(e);var r=n("7a23"),o=n("a5ed"),c=n.n(o),a=function(t){return Object(r["w"])("data-v-b94679b4"),t=t(),Object(r["u"])(),t},s={class:"login__container"},i=a((function(){return Object(r["h"])("img",{class:"login__logo",src:c.a,alt:""},null,-1)})),u={class:"login__title"};function l(t,e,n,o,c,a){var l=Object(r["A"])("LoginForm");return Object(r["t"])(),Object(r["g"])("div",s,[i,Object(r["h"])("h1",u,Object(r["D"])(a.isRouterAdmin?"後台登入":"登入 Alphitter"),1),Object(r["j"])(l)])}n("b0c0");var d=function(t){return Object(r["w"])("data-v-8ea5cdb8"),t=t(),Object(r["u"])(),t},m={class:"login-form__input-box form__input-box"},b=d((function(){return Object(r["h"])("label",{class:"form__label",for:"account"},"帳號",-1)})),f={class:"login-form__input-container form__input-container"},p={class:"login-form__input-box form__input-box"},g=d((function(){return Object(r["h"])("label",{class:"form__label",for:"password"},"密碼",-1)})),h={class:"login-form__input-container form__input-container"},_=d((function(){return Object(r["h"])("button",{class:"login-form__btn btn"},"登入",-1)})),j={class:"login-form__btn--small btn--small"},O=Object(r["i"])(" 註冊Alphitter "),w=d((function(){return Object(r["h"])("span",null," · ",-1)})),v=Object(r["i"])(" 後台登入 "),k=Object(r["i"])(" 前台登入 ");function x(t,e,n,o,c,a){var s=Object(r["A"])("router-link");return Object(r["t"])(),Object(r["g"])("form",{onSubmit:e[2]||(e[2]=Object(r["L"])((function(){return a.handleSubmit&&a.handleSubmit.apply(a,arguments)}),["stop","prevent"]))},[Object(r["h"])("div",m,[b,Object(r["h"])("div",f,[Object(r["J"])(Object(r["h"])("input",{id:"account","onUpdate:modelValue":e[0]||(e[0]=function(t){return c.account=t}),name:"account",type:"account",class:"login-form__input form__input",required:"",autofocus:""},null,512),[[r["F"],c.account]])])]),Object(r["h"])("div",p,[g,Object(r["h"])("div",h,[Object(r["J"])(Object(r["h"])("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=function(t){return c.password=t}),name:"password",type:"password",class:"login-form__input form__input",required:"",autocomplete:""},null,512),[[r["F"],c.password]])])]),_,Object(r["h"])("div",j,[a.isRouterAdmin?Object(r["f"])("",!0):(Object(r["t"])(),Object(r["g"])(r["a"],{key:0},[Object(r["j"])(s,{to:"/signup",class:"btn--small__text"},{default:Object(r["I"])((function(){return[O]})),_:1}),w],64)),a.isRouterAdmin?Object(r["f"])("",!0):(Object(r["t"])(),Object(r["e"])(s,{key:1,class:"btn--small__text",to:"/admin/login"},{default:Object(r["I"])((function(){return[v]})),_:1})),a.isRouterAdmin?(Object(r["t"])(),Object(r["e"])(s,{key:2,class:"btn--small__text",to:"/login"},{default:Object(r["I"])((function(){return[k]})),_:1})):Object(r["f"])("",!0)])],32)}var A=n("1da1"),I=(n("96cf"),n("7696")),$=n("be6c"),y={name:"LoginForm",data:function(){return{account:"",password:"",isProcessing:!1,adminToggled:!1,isNotice:!1}},computed:{isRouterAdmin:function(){var t=this.$route.name;return"AdminLogin"===t}},methods:{handleSubmit:function(){var t=this;return Object(A["a"])(regeneratorRuntime.mark((function e(){var n,r,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.account){e.next=3;break}throw new Error("請輸入帳號");case 3:if(t.password){e.next=5;break}throw new Error("請輸入密碼");case 5:if(t.isProcessing=!0,!t.isRouterAdmin){e.next=25;break}return e.next=9,$["a"].signIn({account:t.account,password:t.password});case 9:if(n=e.sent,r=n.data,"success"===r.status){e.next=13;break}throw new Error(r.message);case 13:if("admin"===r.user.role){e.next=19;break}return t.$store.commit("authentication/revokeAuthentication"),t.$router.push("/login"),t.$store.commit("noticeInfo/toggleNotice",{type:"error",message:"帳號不存在"}),t.isProcessing=!1,e.abrupt("return");case 19:localStorage.setItem("token",r.token),t.$store.commit("authentication/setCurrentUser",r.user),t.$store.dispatch("authentication/fetchCurrentUser"),t.$router.push("/admin/users"),e.next=41;break;case 25:return e.next=27,I["a"].signIn({account:t.account,password:t.password});case 27:if(o=e.sent,c=o.data,"success"===c.status){e.next=31;break}throw new Error(c.message);case 31:if("admin"!==c.user.role){e.next=37;break}return t.$store.commit("authentication/revokeAuthentication"),t.$router.push("/login"),t.$store.commit("noticeInfo/toggleNotice",{type:"error",message:"帳號不存在"}),t.isProcessing=!1,e.abrupt("return");case 37:localStorage.setItem("token",c.token),t.$store.commit("authentication/setCurrentUser",c.user),t.$store.dispatch("authentication/fetchCurrentUser"),t.$router.push("/home");case 41:e.next=48;break;case 43:e.prev=43,e.t0=e["catch"](0),console.log("LoginForm handleSubmit error: ",e.t0),t.$store.commit("noticeInfo/toggleNotice",{type:"error",message:"帳號不存在"}),t.isProcessing=!1;case 48:case"end":return e.stop()}}),e,null,[[0,43]])})))()}}},R=(n("fd64"),n("6b0d")),L=n.n(R);const U=L()(y,[["render",x],["__scopeId","data-v-8ea5cdb8"]]);var P=U,S={name:"Login",components:{LoginForm:P},computed:{isRouterAdmin:function(){var t=this.$route.name;return"AdminLogin"===t}}};n("3061");const F=L()(S,[["render",l],["__scopeId","data-v-b94679b4"]]);e["default"]=F},be6c:function(t,e,n){"use strict";var r=n("2fa3");e["a"]={signIn:function(t){var e=t.account,n=t.password;return r["a"].post("/admin/signin",{account:e,password:n})},articles:{getAll:function(){return r["a"].get("admin/tweets")},delete:function(t){var e=t.tweetId;return r["a"].delete("admin/tweets/".concat(e))}},getUsers:function(){return r["a"].get("admin/users")}}},fd64:function(t,e,n){"use strict";n("900e")}}]);
//# sourceMappingURL=chunk-6e03ca1a.661c7d3c.js.map