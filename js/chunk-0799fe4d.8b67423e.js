(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0799fe4d"],{"47c3":function(e,t,r){"use strict";r.r(t);var n=r("7a23"),i={class:"private-message__container"};function s(e,t,r,s,a,c){var o=Object(n["A"])("ChatUserList"),u=Object(n["A"])("Chatroom");return Object(n["t"])(),Object(n["g"])("div",i,[Object(n["j"])(o,{users:e.userList},null,8,["users"]),Object(n["j"])(u,{onChatSubmit:c.chatSubmit,ref:"chatroomRef"},null,8,["onChatSubmit"])])}var a=r("1da1"),c=r("5530"),o=(r("96cf"),r("498a"),r("caad"),r("2532"),r("a7d5")),u=r("ffe0"),d=r("5502"),h={name:"ChatPrivate",components:{ChatUserList:o["a"],Chatroom:u["a"]},data:function(){return{content:"",currentUserId:-1}},computed:Object(c["a"])(Object(c["a"])({},Object(d["d"])({currentUser:function(e){return e.authentication.currentUser},activeReceiver:function(e){return e.chatPrivate.activeReceiver},activeChat:function(e){return e.chatPrivate.activeChat},roomList:function(e){return e.chatPrivate.roomList}})),Object(d["b"])({userList:"chatPrivate/getUserList"})),created:function(){this.$socket.connect(),this.currentUserId=this.currentUser.id},sockets:{privateHistory:function(e){this.$store.commit("chatPrivate/setPrivateHistory",e)},privateMessage:function(e){this.addMessage(e)}},mounted:function(){this.$nextTick((function(){this.joinPrivate(this.currentUserId)}))},methods:{joinPrivate:function(e){this.$socket.emit("privateEnter",{senderId:e})},handleReceiver:function(e){this.$store.commit("chatPrivate/setPrivateMessageList",e)},chatSubmit:function(e){e.trim()&&this.$socket.emit("privateMessage",{content:e,senderId:this.currentUserId,receiverId:this.activeReceiver})},addMessage:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.roomList.includes(e.newMessages.RoomId)){r.next=5;break}return t.joinPrivate(t.currentUserId),r.abrupt("return");case 5:e.newMessages.RoomId===t.activeChat&&(e.newMessages.isRead=!0,t.$socket.emit("getRoomHistory",{currentUserId:t.currentUserId,roomId:t.activeChat}));case 6:return r.next=8,t.$store.commit("chatPrivate/addNewMessage",e);case 8:t.$refs.chatroomRef.scrollToggle(!0);case 9:case"end":return r.stop()}}),r)})))()}}},v=(r("a854"),r("6b0d")),m=r.n(v);const f=m()(h,[["render",s],["__scopeId","data-v-3e64fc46"]]);t["default"]=f},a854:function(e,t,r){"use strict";r("b752")},b752:function(e,t,r){}}]);
//# sourceMappingURL=chunk-0799fe4d.8b67423e.js.map